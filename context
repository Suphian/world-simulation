This document explains the simulationâ€™s world, variables, and formulas so Cursor can â€œthink with contextâ€ when helping implement features. It maps directly to fields and functions in the singleâ€‘file HTML app.

---

## ğŸŒ The World & Civilizations

- **Geography:** A ring of lands around the **Tesselated Sea** with chokepoint straits, coastal trade, interior rivers, and a hazardous outer ocean (**Outer Shoals**).  
- **Ambient Threat:** The Outer Shoals create raids, storms, and piracy that apply **External Pressure** to coastal powers.

**Civilizations (default preset: `tess`):**

1. **SAL** â€” *The Salanic Empire* (color `#4FA3FF`)  
   - **Religion:** Imperial Cult Â· **Government:** Ironâ€‘fisted Monarchy  
   - **Defaults (Pillars):** Religion 75, Government 90, Economy 70, Knowledge 85, Culture 60, Social 70  
   - **Defaults (Secondary):** Pop 60, Urban 65, Infra 75, Health 65, Army 85, Navy 70, Diplomacy 60, Resources 75, TradeOpen 55, Tax 80

2. **LYR** â€” *Kingdom of Lyrica* (color `#FF6E6E`)  
   - **Religion:** Divine Kingship Â· **Government:** Theocratic Monarchy  
   - **Pillars:** 95, 80, 65, 55, 85, 75

3. **THO** â€” *Republic of Thornwall* (color `#7AD37A`)  
   - **Religion:** Rational Humanism Â· **Government:** Merchant Council Republic  
   - **Pillars:** 40, 70, 85, 80, 70, 60

4. **KHA** â€” *Khaldur Nomad Clans* (color `#FFD166`)  
   - **Religion:** Shamanistic Animism Â· **Government:** Tribal Confederation  
   - **Pillars:** 60, 45, 50, 35, 55, 85

5. **GLA** â€” *Glass League* (color `#B66DFF`)  
   - **Religion:** Lattice of Saints Â· **Government:** Merchant Council  
   - **Pillars:** 45, 65, 85, 80, 70, 45

---

## ğŸ›ï¸ Civilizational Pillars (Sliders)

Each civ has six sliders (0â€“100) that define it. Adjusting them changes outcomes.

### A) Religion & Culture
- **Religious Unity â†” Pluralism** â€” â†‘ Unity = +Cohesion, +Morale; â†“ Unity = +Pluralism, +Innovation but risk of unrest.  
- **Tolerance** â€” â†‘ = +Trade, +Diplomacy, +Innovation; â†“ = cultural rigidity, unrest.  
- **Churchâ€“State Integration** â€” â†‘ Stability; â†“ = secular freedom, less cohesion.

### B) Government & Institutions
- **Centralization** â€” â†‘ Mobilization/tax; overâ€‘centralization reduces Cohesion.  
- **Rule of Law** â€” â†‘ = âˆ’Corruption, +Logistics, +Stability.  
- **Tax Capacity** â€” â†‘ Treasury; very high depresses morale.

### C) Goods & Economy
- **Agricultural Surplus** â€” baseline Prosperity & support.  
- **Industrialization** â€” converts surplus into tech & military.  
- **Trade Openness** â€” â†‘ Growth; vulnerable to blockades.  
- **Resource Endowment (0â€“200)** â€” more metals/energy = stronger industry/upkeep.

### D) Writing, Literacy & Knowledge
- **Literacy** â€” admin/logistics/research.  
- **Media** â€” spreads ideas; dissent risk.  
- **Universities** â€” accelerates innovation & culture.

### E) Arts & Cultural Capital
- **Patronage** â€” +Soft Power, +Morale, treasury drain.  
- **Cultural Prestige** â€” diplomacy & trade bonus.

### F) Social Structure
- **Rigidity** â€” stability now; less innovation.  
- **Inequality** â€” fuels growth until thresholds; high unrest.  
- **Cohesion** â€” morale & resilience; very high suppresses diversity.

---

## ğŸ“Š Derived Indices

- **Prosperity** = weighted Agri + Industry + Trade + Resources + Infra + Law + Health âˆ’ WarPenalty  
- **Stability/Morale** = Cohesion + RuleOfLaw + Prosperity + ReligiousUnity + Patronage âˆ’ (Inequality + Rigidity + TaxBurden + Conflict + WarExhaustion)  
- **Innovation** = Literacy + Universities + Media + Trade + Urban + Tolerance âˆ’ RigidityPenalty  
- **Soft Power** = 0.4*CulturalPrestige + 0.35*Diplomacy + 0.15*TradeOpen + 0.10*RuleOfLaw  
- **Military Effectiveness** = Army/Navy Ã— Economy Ã— Supply Ã— Morale Ã— Resource bonuses

---

## âš”ï¸ War, Colonization, Trade

- **War:** Adjacent hexes contested if civs at war. Battles flip hexes with flare animations.  
- **Colonization:** Civs with Prosperity, Morale, Navy/Army above thresholds can claim neutral hexes (animated halo).  
- **Trade:** Capitals â†” resources & capitals. Convoys animate; throughput depends on TradeOpenness, Infra, Stability, Navy. Blockades reduce throughput.

---

## ğŸ“œ Events

Events are inline JSON objects with conditions + effects. Examples:  
- Religious Schism, Revival, Harvest Failure, Industrial Boom, Golden Age, Naval Blockade, Colonial Uprising, Peace Conference.

---

## ğŸ“° Newsfeed

Every few ticks, the sim outputs a **3â€“6 line summary**: whoâ€™s at war, richest civ, top trader, colonization attempts, morale/innovation leaders, blockades, etc.  

This feeds into the **World Newsfeed** UI and can be copied to clipboard.

---

## ğŸ”§ Developer Notes

- All constants in `BALANCE` object (easy to tweak).  
- Pure functions for computing indices (safe for previews).  
- Singleâ€‘file HTML = no dependencies.  
- Cursor can use this doc as **domain knowledge** when editing/adding features.

**End of Context Document**
"""

with open("/mnt/data/tess_sim_cursor_context_singleblock.md", "w", encoding="utf-8") as f:
    f.write(context_block)

"/mnt/data/tess_sim_cursor_context_singleblock.md"
